<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ãƒªãƒãƒ¼ã‚¹1999 æ‰€æŒç®¡ç†ãƒ„ãƒ¼ãƒ«ï¼ˆè©¦ä½œãƒ»è£…é£¾ç‰ˆï¼‰</title>
<style>
body{
  font-family: "Noto Sans JP", system-ui, -apple-system;
  margin:0; padding:20px;
  background: radial-gradient(circle at center,#1e1e1e 40%, #111 100%);
  color:#f5f5f5;
}
h1{font-size:1.6em; margin-bottom:10px; text-shadow:0 0 5px #a0a0a0;}
section{
  background:rgba(255,255,255,0.06);
  padding:16px;
  border:1px solid rgba(255,255,255,0.1);
  border-radius:12px;
  margin-bottom:24px;
  backdrop-filter: blur(6px);
}
.grid{
  display:flex; flex-wrap:wrap; gap:12px;
}
.card{
  width:180px;
  background:rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.15);
  border-radius:10px;
  padding:10px;
  text-align:center;
  transition:0.2s;
}
.card:hover{transform:translateY(-3px); box-shadow:0 0 8px rgba(255,255,255,0.15);}
.card img{
  width:100%; border-radius:8px; margin-bottom:6px;
}
.row{margin:4px 0;}
button{
  background:rgba(255,255,255,0.1);
  color:#fff; border:none;
  border-radius:4px;
  padding:2px 6px;
  cursor:pointer;
  transition:0.2s;
}
button:hover{background:rgba(255,255,255,0.25);}
.dark{opacity:0.3;}
h2{
  margin:0 0 10px 0;
  font-size:1.2em;
  color:#ffeb99;
  border-left:4px solid #cfae4e;
  padding-left:8px;
}
#copyBtn{
  background:#cfae4e;
  color:#222;
  border-radius:6px;
  padding:4px 10px;
  font-weight:bold;
}
label{margin-left:10px; font-size:0.9em;}
</style>
</head>
<body>
<h1>ãƒªãƒãƒ¼ã‚¹1999 æ‰€æŒç®¡ç†ãƒ„ãƒ¼ãƒ«ï¼ˆè©¦ä½œãƒ»è£…é£¾ç‰ˆï¼‰</h1>
<div>
  <button id="copyBtn">å…±æœ‰URLã‚’ã‚³ãƒ”ãƒ¼</button>
  <label><input type="checkbox" id="hideUnowned"> æœªæ‰€æŒã‚’æš—ãè¡¨ç¤º</label>
</div>

<section>
  <h2>ğŸ§ ã‚­ãƒ£ãƒ©ä¸€è¦§</h2>
  <div id="charGrid" class="grid"></div>
</section>

<section>
  <h2>ğŸ’ å¿ƒç›¸ä¸€è¦§</h2>
  <div id="mindGrid" class="grid"></div>
</section>

<script>
const data = {
  characters: [
    {id:"annie", name:"ã‚¢ãƒ‹ãƒ¼", level:70, insight:3, sozo:5, kyomei:12, img:"https://via.placeholder.com/180x180/222/eee?text=Annie"},
    {id:"regulus", name:"ãƒ¬ã‚°ãƒ«ã‚¹", level:60, insight:2, sozo:3, kyomei:8, img:"https://via.placeholder.com/180x180/333/fff?text=Regulus"},
  ],
  minds: [
    {id:"starry-mind", name:"æ˜Ÿç©ºã®å¿ƒ", owned:true, level:40, img:"https://via.placeholder.com/180x180/113355/fff?text=Starry"},
    {id:"sunset-memory", name:"å¤•æ˜ ãˆã®è¨˜æ†¶", owned:false, level:0, img:"https://via.placeholder.com/180x180/552211/fff?text=Sunset"},
  ]
};

function encodeData(){ return btoa(JSON.stringify(data)); }
function decodeData(str){ try{return JSON.parse(atob(str));}catch(e){return null;} }

function updateURL(){
  const url = new URL(location.href);
  url.searchParams.set('data', encodeData());
  history.replaceState({}, '', url);
}

function loadFromURL(){
  const url = new URL(location.href);
  const p = url.searchParams.get('data');
  if(!p) return;
  const d = decodeData(p);
  if(!d) return;
  if(Array.isArray(d.characters)) data.characters = d.characters;
  if(Array.isArray(d.minds)) data.minds = d.minds;
}

document.getElementById('copyBtn').addEventListener('click', async ()=>{
  updateURL();
  try{
    await navigator.clipboard.writeText(location.href);
    alert("å…±æœ‰URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
  }catch(e){
    prompt("ã“ã®URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ï¼š", location.href);
  }
});

document.getElementById('hideUnowned').addEventListener('change', ()=>{renderMinds();});

function renderCharacters(){
  const grid = document.getElementById('charGrid');
  grid.innerHTML = "";
  data.characters.forEach(ch=>{
    const card = document.createElement('div');
    card.className = 'card';
    const img = document.createElement('img'); img.src = ch.img;
    const name = document.createElement('div'); name.textContent = ch.name;
    const lv = document.createElement('div');
    lv.className = 'row';
    lv.innerHTML = `Lv: <button class="lvminus">-</button><span class="lv">${ch.level}</span><button class="lvplus">+</button>`;
    const insight = document.createElement('div');
    insight.className = 'row';
    insight.innerHTML = `æ´å¯Ÿ: ${"â˜…".repeat(ch.insight)}${"â˜†".repeat(3-ch.insight)}`;
    insight.addEventListener('click', ()=>{ch.insight=(ch.insight+1)%4;updateURL();renderCharacters();});
    const sozo = document.createElement('div');
    sozo.className = 'row';
    sozo.innerHTML = `å¡‘åƒ: ${"â˜…".repeat(ch.sozo)}${"â˜†".repeat(5-ch.sozo)}`;
    sozo.addEventListener('click', ()=>{ch.sozo=(ch.sozo+1)%6;updateURL();renderCharacters();});
    const kyomei = document.createElement('div');
    kyomei.className = 'row';
    kyomei.innerHTML = `å…±é³´: <button class="kmminus">-</button><span class="km">${ch.kyomei}</span><button class="kmplus">+</button>`;
    card.append(img,name,lv,insight,sozo,kyomei);
    grid.appendChild(card);

    card.querySelector(".lvminus").addEventListener('click', ()=>{if(ch.level>1)ch.level--;updateURL();renderCharacters();});
    card.querySelector(".lvplus").addEventListener('click', ()=>{if(ch.level<70)ch.level++;updateURL();renderCharacters();});
    card.querySelector(".kmminus").addEventListener('click', ()=>{if(ch.kyomei>0)ch.kyomei--;updateURL();renderCharacters();});
    card.querySelector(".kmplus").addEventListener('click', ()=>{if(ch.kyomei<15)ch.kyomei++;updateURL();renderCharacters();});
  });
}

function renderMinds(){
  const grid = document.getElementById('mindGrid');
  grid.innerHTML = "";
  const hide = document.getElementById('hideUnowned').checked;
  data.minds.forEach(m=>{
    const card = document.createElement('div');
    card.className = 'card';
    if(!m.owned && hide) card.classList.add('dark');
    const img = document.createElement('img'); img.src = m.img;
    const name = document.createElement('div'); name.textContent = m.name;
    const own = document.createElement('div');
    own.className = 'row';
    own.innerHTML = `æ‰€æŒ: <input type="checkbox" ${m.owned?"checked":""}>`;
    const lv = document.createElement('div');
    lv.className = 'row';
    lv.innerHTML = `Lv: <button class="mlvminus">-</button><span class="mlv">${m.level}</span><button class="mlvplus">+</button>`;
    card.append(img,name,own,lv);
    grid.appendChild(card);

    own.querySelector('input').addEventListener('change',(e)=>{m.owned=e.target.checked;updateURL();renderMinds();});
    card.querySelector(".mlvminus").addEventListener('click', ()=>{if(m.level>0)m.level--;updateURL();renderMinds();});
    card.querySelector(".mlvplus").addEventListener('click', ()=>{if(m.level<60)m.level++;updateURL();renderMinds();});
  });
}

loadFromURL(); renderCharacters(); renderMinds();
</script>
</body>
</html>
